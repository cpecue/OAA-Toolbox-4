{% extends "layout.html" %}
{% block content %}
<link href="static/search.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
  <link rel="stylesheet" href="static/styles.css">
<script src="../static/scripts/declaration.js"></script>

<body style="background-color: #292b2c;"></body>
                <main style="background-color: #292b2c;">
                    <div class="container-fluid">
                        <div class="spinnerLocation mt-4" id="spinnerLocation"></div>
                        <ol class="breadcrumb mt-4">
                            <li class="breadcrumb-item active">Declaration</li>
                        </ol>
<div class="card text-white bg-dark text-center mb-4">
                        <div class="card-header">Advisor Information</div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-lg-3 mb-3">
                                        <select class="form-select form-select-lg" aria-label="declaringSemester" id="effective_term">
                                          <option selected value="0">This Semester</option>
                                          <option value="1">Next Semester</option>
                                        </select>
                                </div>
                                <div class="col-lg-3">
                                    <input type="text" class="form-control form-control-lg courses" id="advisorEmail" placeholder="Advisor Email">
                                </div>
                                <div class="col-lg-6">
                                    <input type="password" class="form-control form-control-lg courses" id="advisorPw" placeholder="Advisor Password">
                                </div>
                            </div>
                        </div>
</div>
<div class="card text-white bg-dark text-center mb-4">
                        <div class="card-header">Student Information</div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-lg-6">
                                    <input type="text" class="form-control form-control-lg courses" id="studentFN" placeholder="First Name">
                                </div>
                                <div class="col-lg-6">
                                    <input type="text" class="form-control form-control-lg courses" id="studentLN" placeholder="Last Name">
                                </div>
                                <div class="col-lg-6">
                                    <input type="text" class="form-control form-control-lg courses" id="studentID" placeholder="800#">
                                </div>
                                <div class="col-lg-6">
                                    <input type="email" class="form-control form-control-lg courses" id="studentEmail" placeholder="Email">
                                </div>
                                <div class="col-lg-6">
                                    <input type="text" class="form-control form-control-lg courses bfh-phone" id="studentPhone" placeholder="Phone Number" data-format="+1 (ddd) ddd-dddd">
                                </div>
                                <div class="col-lg-6 mb-2">
                                        <select class="form-select form-select-lg" aria-label="student status" id="status" onchange="studentFromDegree()">
                                          <option selected value="0">Undeclared</option>
                                          <option value="1">Declared</option>
                                        </select>
                                </div>
                                <div class="col-lg-3 mb-2">
                                        <select class="form-select form-select-lg" aria-label="student_standing" id="student_standing" onchange="">
                                          <option selected value="0">On Good Standing</option>
                                          <option value="1">Not On Good Standing</option>
                                        </select>
                                </div>
                                <div class="col-lg-3 mb-2">
                                        <select class="form-select form-select-lg" aria-label="student_honors" id="student_honors" onchange="">
                                          <option selected value="0">Not Honors</option>
                                          <option value="1">Honors</option>
                                        </select>
                                </div>
                                <div class="col-lg-3 mb-2">
                                        <select class="form-select form-select-lg" aria-label="student_senior" id="student_senior" onchange="">
                                          <option selected value="0">Not Senior with Degree</option>
                                          <option value="1">Senior with Degree</option>
                                        </select>
                                </div>
                                <div class="col-lg-3 mb-2">
                                        <select class="form-select form-select-lg" aria-label="student_transfer" id="student_transfer" onchange="">
                                          <option selected value="0">Not Transfer Student</option>
                                          <option value="1">Transfer Student</option>
                                        </select>
                                </div>
                            </div>
                        </div>
</div>
<div id="fromMajor"></div>

<!--Second Degree Area for Testing-->
<div class="card text-white bg-dark text-center mb-4">
        <div class="card-header">To: Degree Information</div>
        <div class="card-body" id="degreeArea">
            <div class="row row-test" id="rowArea">
                                    <div class="col-lg-6">
                                        <div class="input-group mb-3">
                                        <input type="text" class="form-control form-control-lg courses search-input-major" id="studentMajor" aria-label="Recipient's username" area-describedby="basic-addon2" placeholder="Major">
                                          <div class="input-group-append">
                                            <button class="input-group-text btn btn-dark info-button majorModalBtn" data-toggle="modal" data-target="#majorModal" id="basic-addon2">ⓘ</button>
                                          </div>
                                        </div>
                                        <div class="suggestions"></div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="input-group mb-3">
                                        <input type="text" class="form-control form-control-lg courses search-input-minor" id="studentMinor" aria-label="Recipient's username" area-describedby="basic-addon2" placeholder="Minor">
                                          <div class="input-group-append">
                                            <button class="input-group-text btn btn-dark info-button" data-toggle="modal" data-target="#minorModal" id="basic-addon3">ⓘ</button>
                                          </div>
                                        </div>
                                        <l><div class="minorSuggestions"></div></l>

                                    </div>

                                <div id="newMajorHere" class="col-lg-6"></div>
                                <div id="newMinorHere" class="col-lg-6"></div>

            </div>

            <button id="addSecondMajor" class="btn btn-secondary add" onclick="" style="width:100%;">+</button>
            <div id="deleteSecondMajor"></div>
        </div>
</div>

                                            <div class="optionBox">
    <div class="block mb-3 container-fluid">

</div>

<!--End Second Degree Area for Testing-->




<!-- Modal -->
<div class="modal fade majorModalClass" id="majorModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title Major1Title" id="Major1Title">Declaration Information</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body major1Information" id="Major1Information">



      </div>
    </div>
  </div>
</div>
<!--                        Minor Modal-->


<!--                                                Declaring Modal -->
<div class="modal fade declaringModalClass" id="declaringModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title Major1Title" id="declaringModalTitle">Declaring...</h5>

        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body declaringModalBody" id="declaringModalBody">
<div class="spinner-border m-5" role="status">
  <span class="visually-hidden">Loading...</span>
</div>
</div>
</div>


                </main>
<div class="container-fluid" style="background-color: #292b2c;">
<footer>
                            <div class="row">
                            <div class="col-lg-6">
                                <div class="btn btn-lg btn-dark mb-3" style="width:100%">Undeclare</div>
                            </div>
                            <div class="col-lg-6 declareBtnLocation" id="declareBTNLocation">
                                <div class="btn btn-lg btn-dark mb-3 declareBtn" style="width:100%">Declare</div>
                        </div>
                            </div>
</footer>
    </div>
        <script src="static/search_box.js"></script>
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
        <script src="static/scripts.js"></script>
        <script>

        $(document).on('click','.add',function(){
            $(this).remove();
            $('.block:last').before('<div class="card text-center text-white bg-dark mb-4"><div class="card-header">Second Major Information</div><div class="card-body" id="degreeArea"><div class="row" id="rowArea"><div class="col-lg-6"><div class="input-group mb-3"><input type="text" class="form-control form-control-lg courses search-input" id="studentMajor" aria-label="Recipients username" area-describedby="basic-addon2" placeholder="Second Major"><div class="input-group-append"><button class="input-group-text btn btn-dark info-button" data-toggle="modal" data-target="#majorModal" id="basic-addon2">ⓘ</button></div></div><div class="suggestions"></div></div><div class="col-lg-6"><div class="input-group mb-3"><input type="text" class="form-control form-control-lg courses search-input" id="studentMinor" aria-label="Recipients username" area-describedby="basic-addon2" placeholder="Second Minor"><div class="input-group-append"><button class="input-group-text btn btn-dark info-button" data-toggle="modal" data-target="#minorModal" id="basic-addon3">ⓘ</button></div></div><div class="suggestions"></div></div></div><button id="addSecondMajor" class="btn btn-danger remove" onclick="" style="width:100%;">x</button></div></div>');
            });
            $('.optionBox').on('click','.remove',function() {
            $(this).parent().parent().remove();
            $('.row-test').after('<button id="addSecondMajor2" class="btn btn-secondary add" onclick="" style="width:100%;">+</button>');
        });

</script>
<script>
const countries = {{ majors_list|safe }};
const minors = {{ minors_list|safe }};
$(".declareBtn").click(function() {

    var declareBTN = document.getElementById('declareBtn');
    var spinner = document.getElementById('declareBTNLocation');
    spinner.innerHTML = `<button class="btn btn-lg btn-dark mb-3 btn-block" type="button" disabled>
  <span class="spinner-grow text-white" role="status" aria-hidden="true"></span>
  Declaring, wait...
</button>`;
    var advisorEmail = document.getElementById('advisorEmail').value;
    let effective_term = document.getElementById('effective_term');
    let effective_term_text = effective_term.options[effective_term.selectedIndex].text;
    var advisorPw = document.getElementById('advisorPw').value;
    var studentFN = document.getElementById('studentFN').value;
    var studentLN = document.getElementById('studentLN').value;
    var studentID = document.getElementById('studentID').value;
    var studentEmail = document.getElementById('studentEmail').value;
    var studentPhone = document.getElementById('studentPhone').value;
    let status = document.getElementById('status');
    let status_text = status.options[status.selectedIndex].text;
    var studentMajor = document.getElementById('studentMajor').value;
    var studentMinor = document.getElementById('studentMinor').value;
    var index = countries.findIndex(x => x.name === studentMajor);
    var test = countries[index]['Requirements'];
    var majorCode = countries[index]['majorCode'];
    var collegeCode = countries[index]['collegeCode'];
    var degreeCode = countries[index]['degreeCode'];
    var majorConcentration = countries[index]['majorConcentration'];
    console.log(majorConcentration)

    var myData = {majorConcentration: majorConcentration, majorCode: majorCode, degreeCode: degreeCode, collegeCode: collegeCode, advisorEmail: advisorEmail, advisorPw: advisorPw, effective_term_text: effective_term_text, studentFN: studentFN, studentLN: studentLN, studentID: studentID, studentEmail: studentEmail, studentPhone: studentPhone, status_text: status_text};

    $.ajax({
        url: '/_runSelenium',
        type: 'POST',
        data: myData,
        success: function(response) {
            location.href = "success"
        },
        error: function(error) {

        }
    });
});

var selectedSuggestionIndex = -1;
const searchInputMinors = document.querySelector('.search-input-minor');
const suggestionsPanelMinors = document.querySelector('.minorSuggestions');
const minorInput = document.querySelector('.minorModal');

const searchInput = document.querySelector('.search-input-major');
const suggestionsPanel = document.querySelector('.suggestions');
const majorInput = document.querySelector('.majorModal');

function resetSelectedSuggestion() {
  for (var i = 0; i < suggestionsPanel.children.length; i++) {
    suggestionsPanel.children[i].classList.remove('selected');
  }
}

function resetSelectedMinorsSuggestion() {
  for (var i = 0; i < suggestionsPanelMinors.children.length; i++) {
    suggestionsPanelMinors.children[i].classList.remove('selected');
  }
}

searchInput.addEventListener('keyup', function(e) {
  if (e.key === 'ArrowDown') {
    resetSelectedSuggestion();
    selectedSuggestionIndex = (selectedSuggestionIndex < suggestionsPanel.children.length - 1) ? selectedSuggestionIndex + 1 : suggestionsPanel.children.length - 1;
    suggestionsPanel.children[selectedSuggestionIndex].classList.add('selected');
    return;
  }
  if (e.key === 'ArrowUp') {
    resetSelectedSuggestion();
    selectedSuggestionIndex = (selectedSuggestionIndex > 0) ? selectedSuggestionIndex -1 : 0;
    suggestionsPanel.children[selectedSuggestionIndex].classList.add('selected');
    return;
  }
  if (e.key === 'Enter') {
    searchInput.value = suggestionsPanel.children[selectedSuggestionIndex].innerHTML;
    suggestionsPanel.classList.remove('show');
    selectedSuggestionIndex = -1;
    return;
  }
  suggestionsPanel.classList.add('show');
  const input = searchInput.value;
  suggestionsPanel.innerHTML = '';
  const suggestions = countries.filter(function(country) {
    return country.name.toLowerCase().includes(input.toLowerCase());
  });
  suggestions.forEach(function(suggested) {
    const div = document.createElement('div');
    div.innerHTML = suggested.name;
    div.setAttribute('class', 'suggestion');
    suggestionsPanel.appendChild(div);
  });
  if (input === '') {
    suggestionsPanel.innerHTML = '';
  }
});

searchInputMinors.addEventListener('keyup', function(e) {
  if (e.key === 'ArrowDown') {
    resetSelectedMinorsSuggestion();
    selectedSuggestionIndex = (selectedSuggestionIndex < suggestionsPanelMinors.children.length - 1) ? selectedSuggestionIndex + 1 : suggestionsPanelMinors.children.length - 1;
    suggestionsPanelMinors.children[selectedSuggestionIndex].classList.add('selected');
    return;
  }
  if (e.key === 'ArrowUp') {
    resetSelectedMinorsSuggestion();
    selectedSuggestionIndex = (selectedSuggestionIndex > 0) ? selectedSuggestionIndex -1 : 0;
    suggestionsPanelMinors.children[selectedSuggestionIndex].classList.add('selected');
    return;
  }
  if (e.key === 'Enter') {
    searchInputMinors.value = suggestionsPanelMinors.children[selectedSuggestionIndex].innerHTML;
    suggestionsPanelMinors.classList.remove('show');
    selectedSuggestionIndex = -1;
    return;
  }
  suggestionsPanelMinors.classList.add('show');
  const input = searchInputMinors.value;
  suggestionsPanelMinors.innerHTML = '';
  const suggestionsMinors = minors.filter(function(minor) {
    return minor.name.toLowerCase().includes(input.toLowerCase());
  });
  suggestionsMinors.forEach(function(suggested) {
    const div = document.createElement('div');
    div.innerHTML = suggested.name;
    div.setAttribute('class', 'minorSuggestions');
    suggestionsPanelMinors.appendChild(div);
  });
  if (input === '') {
    suggestionsPanelMinors.innerHTML = '';
  }
});



document.addEventListener('click', function(e) {
  if (e.target.className === 'suggestion') {
    searchInput.value = e.target.innerHTML;
<!--    suggestionsPanel.classList.remove('show');-->
    suggestionsPanel.innerHTML = '';
    return searchInput.value
  }
});

document.addEventListener('click', function(e) {
  if (e.target.className === 'minorSuggestions') {
    searchInputMinors.value = e.target.innerHTML;
    suggestionsPanelMinors.innerHTML = '';
<!--    suggestionsPanelMinors.classList.remove('show');-->
    return searchInputMinors.value
  }
});



$(function(){
  $('.majorModalBtn').click(function(e){
    e.preventDefault();
    const major = document.getElementById('studentMajor');
    document.getElementById('Major1Title').innerHTML = 'Declaration Information for ' + major.value;
    index = countries.findIndex(x => x.name === major.value);
    test = countries[index]['Requirements'];
    code = countries[index]['majorCode'];
    document.getElementById('Major1Information').innerHTML = test + '<hr />' + '<div class="badge badge-danger mr-3" style="padding:10px;">' + code + '</div>' ;

  });
})
</script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="{{url_for('static', filename='jquery.js') }}">\x3C/script>')</script>
<script>
function studentFromDegree(){
        let status = document.getElementById('status');
        let status_text = status.options[status.selectedIndex].text;
        let fromMajor = document.getElementById('fromMajor');
        if (status_text == "Declared") {
            fromMajor.innerHTML = `                        <div class="card text-white bg-dark text-center mb-4" id="">
                            <div class="card-header">From: Degree Information</div>
                            <div class="card-body" id="">
                                <div class="row row-test" id="">
                                    <div class="col-lg-6">
                                        <div class="input-group mb-3">
                                            <input type="text" class="form-control form-control-lg" id=""
                                                   aria-label="Recipient's username" area-describedby=""
                                                   placeholder="From Major #1">
                                        </div>
                                        <div class="suggestions"></div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="input-group mb-3">
                                            <input type="text" class="form-control form-control-lg" id=""
                                                   aria-label="Recipient's username" area-describedby=""
                                                   placeholder="From Minor #1">
                                        </div>
                                        <div class="suggestions"></div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="input-group mb-3">
                                            <input type="text" class="form-control form-control-lg" id=""
                                                   aria-label="Recipient's username" area-describedby=""
                                                   placeholder="From Major #2">
                                        </div>
                                        <div class="suggestions"></div>
                                    </div>
                                    <div class="col-lg-6">
                                        <div class="input-group mb-3">
                                            <input type="text" class="form-control form-control-lg" id=""
                                                   aria-label="Recipient's username" area-describedby=""
                                                   placeholder="From Minor #2">
                                        </div>
                                        <div class="suggestions"></div>
                                    </div>
                                </div>
                            </div>
                        </div>`;
        } else {
            fromMajor.innerHTML = '';
        }
};

</script>


{% endblock content %}


